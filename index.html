<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8' />
    <meta http-equiv="X-UA-Compatible" content="chrome=1" />
    <meta name="description" content="Django-cities-light : A Country and an (optionnal) City model and simple features" />

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Django-cities-light</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/yourlabs/django-cities-light">View on GitHub</a>

          <h1 id="project_title">Django-cities-light</h1>
          <h2 id="project_tagline">A Country and an (optionnal) City model and simple features</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/yourlabs/django-cities-light/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/yourlabs/django-cities-light/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>django-cities-light -- <em>Simple django-cities alternative</em>
</h1>

<p>This add-on provides models and commands to import country/city data into your
database.
The data is pulled from <code>GeoNames
&lt;http://www.geonames.org/&gt;</code>_ and contains:</p>

<ul>
<li>country names</li>
<li>optionnal city names</li>
</ul><p>Spatial query support is not required by this application.</p>

<p>This application is very simple and is useful if you want to make a simple
address book for example. If you intend to build a fully featured spatial
database, you should use
<code>django-cities
&lt;https://github.com/coderholic/django-cities&gt;</code>_.</p>

<h2>Installation</h2>

<p>Install django-cities-light::</p>

<pre><code>pip install django-cities-light
</code></pre>

<p>Or the development version::</p>

<pre><code>pip install -e git+git@github.com:yourlabs/django-cities-light.git#egg=cities_light
</code></pre>

<p>Add <code>cities_light</code> to your <code>INSTALLED_APPS</code>.</p>

<p>You may not need the city model and database table. A project like
betspire.com doesn't need it for instance. So the City model will be made
'abstract' if this setting is set as such::</p>

<pre><code>CITIES_LIGHT_ENABLE_CITY=False
</code></pre>

<p>Now, run syncdb, it will only create tables for models that are not disabled::</p>

<pre><code>./manage.py syncdb
</code></pre>

<h2>Data update</h2>

<p>Finnaly, populate your database with command::</p>

<pre><code>./manage.py cities_light
</code></pre>

<p>This command is well documented, consult the help with::</p>

<pre><code>./manage.py help cities_light
</code></pre>

<h2>Filtering data import</h2>

<p>An example is worth 1000 words: if you want to import only cities from France,
USA and Belgium you could do as such::</p>

<pre><code>import cities_light

def filter_city_import(sender, items, **kwargs):
    if items[8] not in ('FR', 'US', 'BE'):
        raise cities_light.InvalidItems()

cities_light.signals.city_items_pre_import.connect(filter_city_import)
</code></pre>

<p>Note: this signal gets a list rather than a City instance for performance reasons.</p>

<h2>Configure logging</h2>

<p>This command is made to be compatible with background usage like from cron, to
keep the database fresh. So it doesn't do direct output. To get output from
this command, simply configure a handler and formatter for <code>cities_light</code>
logger. For example::</p>

<pre><code>LOGGING = {
    'version': 1,
    'disable_existing_loggers': False,
    'formatters': {
        'simple': {
            'format': '%(levelname)s %(message)s'
        },
    },
    'handlers': {
        'console':{
            'level':'DEBUG',
            'class':'logging.StreamHandler',
            'formatter': 'simple'
        },
    },
    'loggers': {
        'cities_light': {
            'handlers':['console'],
            'propagate': True,
            'level':'DEBUG',
        },
        # also use this one to see SQL queries
        'django': {
            'handlers':['console'],
            'propagate': True,
            'level':'DEBUG',
        },
    }
}
</code></pre>

<h2>Ajax autocomplete</h2>

<p>django-autocomplete-light</p>

<pre><code>
If `autocomplete_light` from `django-autocomplete-light
&lt;https://github.com/yourlabs/django-autocomplete-light/&gt;`_, you
have two channels and a widget for City ModelChoiceField that has two
autocompletes: one for the country, and one for the city that is filtered by
the selected country. Example usage::

    from django import forms

    import autocomplete_light
    from cities_light.models import City
    from cities_light.widgets import CityAutocompleteWidget

    from models import Address

    class AddressForm(forms.ModelForm):
        city = forms.ModelChoiceField(City.objects.all(),
            widget=CityAutocompleteWidget('CityChannel', max_items=1))

        class Meta:
            model = Address
            widgets = autocomplete_light.get_widgets_dict(Address, 
                autocomplete_exclude=('city'))

django-ajax-selects
</code></pre>

<p>If <code>ajax_selects</code> from
<code>django-ajax-selects
&lt;https://github.com/crucialfelix/django-ajax-selects&gt;</code>_, you
should have two new channels usable right away:</p>

<ul>
<li><code>cities_light_country</code></li>
<li><code>cities_light_city</code></li>
</ul><h2>Ideas for contribution</h2>

<ul>
<li>django-modeltranslation support and alternateNames.txt</li>
<li>country flags support</li>
</ul><p>I might implement this in the next project or refactor of
my projects that use django-cities-light. In the mean time, 
this app just works because it's so simple. I wonder if there's a bug ....</p>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Django-cities-light maintained by <a href="https://github.com/yourlabs">yourlabs</a></p>
        <p>Published with <a href="http://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
